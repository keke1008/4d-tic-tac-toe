# 4D Tic-Tac-Toe - Rotating 4D Grid

4次元格子を回転させてプレイする、スマホ対応の神秘的三目並べゲーム。

**🎮 [今すぐプレイ！](https://keke1008.github.io/4d-tic-tac-toe/)**

## 🌌 特徴

- **3D格子で表現される4次元空間**: 256個のワイヤーフレーム立方体（4x4x4x4）
- **スマホ完全対応**: スワイプで回転、タップでマーク配置
- **回転軸トグル**: 6つの回転平面を自由に選択（XY, XZ, XW, YZ, YW, ZW）
- **Three.js使用**: WebGLによる滑らかな3Dレンダリング
- **4次元回転の可視化**: W座標の変化により色が変化（青→紫）
- **完全な勝利判定**: 4次元空間での全ての可能な方向（80方向以上）で判定

## 🎮 遊び方

### 基本ルール

1. プレイヤーXとOが交互に回転する4次元立方体のセルにマークを配置
2. 4次元空間で4つ並べたプレイヤーが勝利
3. 4x4x4x4 = 256個全てのセルが埋まると引き分け

### 操作方法

#### PC
- **ドラッグ**: 選択した回転軸でグリッドを回転
- **クリック**: セルをクリックしてX/Oを配置

#### スマートフォン/タブレット
- **スワイプ**: 選択した回転軸でグリッドを回転
- **タップ**: セルをタップしてX/Oを配置

#### 共通
- **回転軸トグル**: XY, XZ, XW✨, YZ, YW✨, ZW✨ から選択
  - ✨マークは4次元回転（内側と外側が入れ替わる！）
- **自動回転ボタン**: XW + YZ の同時回転をON/OFF
- **リセットボタン**: ゲームを最初から

### 4次元回転の神秘性

このゲームの最大の特徴は**4次元回転**です：

**3次元回転（XY, XZ, YZ）**
- 通常の回転。見慣れた動き。

**4次元回転（XW, YW, ZW）**
- **内側のセルが外側に出てくる** - 3次元では絶対に不可能！
- **色が変化する** - W座標が変わるため、青→紫→青と色相が変化
- **隠れていたセルが見える** - 4次元の「裏側」が表に回転してくる

例：ZW回転をクリックすると、Z軸とW軸が回転します。
これにより、W=0にあったセルがW=3に移動したり、
3次元では「奥」にあったセルが4次元的に「表」に出てきます。

**これが3次元上では表現できない神秘性です！** ✨

### 勝利条件

4次元空間では以下のような並び方で勝利できます：

- **3次元での勝利**: 同じW層内でX, Y, Z軸のいずれかの方向に4つ並べる
- **4次元対角線**: X, Y, Z, W全ての軸が同時に変化する完全な4次元対角線
- **その他80以上の方向**: 4次元空間では3^4 - 1 = 80通りの方向が存在

## 🔮 4次元立方体の仕組み

このゲームの4次元立方体：

- **セル数**: 256個（4×4×4×4）
- **各セル**: 4次元座標 (x, y, z, w) を持つ
- **回転**: 6つの回転平面で実際に4次元回転
- **投影**: 回転後の4次元座標を3次元→2次元へ投影して表示

画面上で見えるのは、4次元空間で回転している256個のセルを、
リアルタイムで2次元スクリーンに投影した姿です。

回転すると：
- セルの位置が4次元空間で変化
- W座標が変わり、色が変化（青←→紫）
- 深度（Z座標）も変化し、手前に来たり奥に行ったり
- **3次元では見られない配置が現れる**

## 🚀 起動方法

### オンラインでプレイ

**👉 [GitHub Pages でプレイ](https://keke1008.github.io/4d-tic-tac-toe/)**

### ローカルで実行

```bash
# ブラウザでindex.htmlを開く
open index.html

# またはローカルサーバーを起動
python -m http.server 8000
# ブラウザで http://localhost:8000 を開く
```

## 🎨 技術詳細

### レンダリング
- **Three.js**: WebGLベースの3Dレンダリング
- **ワイヤーフレーム格子**: 256個の立方体エッジで構成
- **スプライト**: X/Oマーカーを常にカメラに正対して表示
- **レイキャスティング**: クリック/タップ位置からセルを選択

### 4次元数学
- **4次元座標**: 各セルが (x, y, z, w) の4次元位置を保持
- **回転行列**: 6つの回転平面での完全な4次元回転計算
- **二段階投影**:
  1. 4D → 3D: 透視投影（W軸方向の距離に基づく）
  2. 3D → 2D: Three.jsのカメラによる投影

### インタラクション
- **Pointer Events**: PC/スマホ統一的なタッチ/マウス操作
- **回転制御**: リアルタイムで4次元回転行列を更新
- **モバイル最適化**: タッチスクロール無効化、レスポンシブUI

### 視覚効果
- **W座標による色変化**: 青（W=-2）→ 紫（W=+2）
- **スケーリング**: W座標に基づいてセルサイズを変更（遠近感）
- **不透明度**: W座標に応じてワイヤーフレームの透明度を調整

## 📐 4次元回転の数学

4次元空間では6つの独立した回転平面が存在します：

- **XY平面**: 通常の2D回転
- **XZ平面**: 前後の回転
- **YZ平面**: 横方向の回転
- **XW平面**: X軸と第4次元の回転
- **YW平面**: Y軸と第4次元の回転
- **ZW平面**: Z軸と第4次元の回転

これらを組み合わせることで、3次元では不可能な複雑な回転が実現できます。

## 🌟 楽しみ方のヒント

1. **まずは観察**: 自動回転をONにして、4次元回転の神秘的な動きを観察
2. **4次元回転を体験**: XW, YW, ZW回転をクリックして、内側が外側に出てくる様子を確認
3. **色の変化に注目**: W座標が変わると色が変化する - これが4次元の証
4. **戦略を練る**:
   - 回転させて隠れたセルを見つける
   - 4次元対角線を狙う（X, Y, Z, W全てが変化する方向）
   - 相手に見えないところに3つ並べる準備をする
5. **自動回転を止めて**: じっくり考えたいときは自動回転を停止

## 🎯 今後の拡張案

- **AIプレイヤー**: ミニマックス法での4次元戦略AI
- **より大きなグリッド**: 5x5x5x5（625セル）への拡張
- **リプレイ機能**: 勝利ラインのハイライト表示
- **オンライン対戦**: WebSocketでリアルタイム対戦
- **VR対応**: WebXRでの没入型4次元体験
- **パフォーマンス改善**: インスタンスメッシュでの最適化
- **チュートリアル**: 4次元回転の理解を助けるガイド

---

**4次元空間での思考を楽しんでください！** 🌌✨
